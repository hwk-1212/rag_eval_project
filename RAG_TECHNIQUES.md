# ğŸ¯ RAGæŠ€æœ¯è¯´æ˜æ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»å¹³å°æ”¯æŒçš„5ç§RAGæŠ€æœ¯åŠå…¶ç‰¹ç‚¹ã€‚

## ğŸ“š æŠ€æœ¯åˆ—è¡¨

| æŠ€æœ¯ | éš¾åº¦ | æ•ˆæœ | é€Ÿåº¦ | é€‚ç”¨åœºæ™¯ |
|------|------|------|------|----------|
| Simple RAG | â­ | â­â­â­ | âš¡âš¡âš¡ | åŸºç¡€é—®ç­”ã€å¿«é€ŸåŸå‹ |
| Reranker RAG | â­â­ | â­â­â­â­ | âš¡âš¡ | é«˜ç²¾åº¦æ£€ç´¢ã€å…³é”®æŸ¥è¯¢ |
| Fusion RAG | â­â­â­ | â­â­â­â­ | âš¡âš¡ | æ··åˆæŸ¥è¯¢ã€å¤šæ ·åŒ–æ£€ç´¢ |
| HyDE RAG | â­â­ | â­â­â­ | âš¡ | æŠ½è±¡æŸ¥è¯¢ã€æ¦‚å¿µæ£€ç´¢ |
| Contextual Compression | â­â­â­ | â­â­â­â­ | âš¡ | é•¿æ–‡æ¡£ã€å™ªéŸ³è¿‡æ»¤ |

---

## 1ï¸âƒ£ Simple RAG (åŸºç¡€RAG)

### åŸç†
æœ€åŸºç¡€çš„RAGå®ç°ï¼Œä½¿ç”¨å‘é‡ç›¸ä¼¼åº¦ç›´æ¥æ£€ç´¢æ–‡æ¡£ã€‚

### æµç¨‹
```
ç”¨æˆ·æŸ¥è¯¢ â†’ å‘é‡åŒ– â†’ å‘é‡æ£€ç´¢ â†’ æ–‡æ¡£å¬å› â†’ LLMç”Ÿæˆç­”æ¡ˆ
```

### ä¼˜ç‚¹
- âœ… å®ç°ç®€å•
- âœ… é€Ÿåº¦å¿«
- âœ… èµ„æºå ç”¨å°‘
- âœ… æ˜“äºç†è§£å’Œè°ƒè¯•

### ç¼ºç‚¹
- âŒ å¯èƒ½æ£€ç´¢åˆ°ä¸ç›¸å…³æ–‡æ¡£
- âŒ ä¾èµ–embeddingè´¨é‡
- âŒ æ— æ³•å¤„ç†å…³é”®è¯åŒ¹é…

### é€‚ç”¨åœºæ™¯
- åŸºç¡€æ–‡æ¡£é—®ç­”
- å¿«é€ŸåŸå‹éªŒè¯
- èµ„æºå—é™ç¯å¢ƒ

### å‚æ•°é…ç½®
```python
{
    "top_k": 5,           # æ£€ç´¢æ–‡æ¡£æ•°é‡
    "chunk_size": 500,    # åˆ†å—å¤§å°
    "chunk_overlap": 100  # é‡å å¤§å°
}
```

---

## 2ï¸âƒ£ Reranker RAG (é‡æ’åºRAG)

### åŸç†
å…ˆç”¨å‘é‡æ£€ç´¢è·å–å€™é€‰æ–‡æ¡£ï¼Œå†ç”¨ä¸“é—¨çš„é‡æ’åºæ¨¡å‹ç²¾ç¡®æ‰“åˆ†ï¼Œé€‰å‡ºæœ€ç›¸å…³çš„æ–‡æ¡£ã€‚

### æµç¨‹
```
ç”¨æˆ·æŸ¥è¯¢ â†’ å‘é‡æ£€ç´¢(top 20) â†’ Rerankeré‡æ’åº â†’ é€‰æ‹©top 5 â†’ LLMç”Ÿæˆ
```

### ä¼˜ç‚¹
- âœ… æ˜¾è‘—æå‡æ£€ç´¢å‡†ç¡®æ€§
- âœ… è¿‡æ»¤ä¸ç›¸å…³æ–‡æ¡£
- âœ… é€‚ç”¨äºå…³é”®ä»»åŠ¡
- âœ… æ•ˆæœæå‡æ˜æ˜¾ï¼ˆé€šå¸¸+10-20%ï¼‰

### ç¼ºç‚¹
- âŒ å¢åŠ ä¸€æ¬¡æ¨¡å‹è°ƒç”¨
- âŒ å»¶è¿Ÿç•¥é«˜
- âŒ éœ€è¦RerankeræœåŠ¡

### é€‚ç”¨åœºæ™¯
- å¯¹å‡†ç¡®æ€§è¦æ±‚é«˜çš„åœºæ™¯
- å…³é”®ä¸šåŠ¡æŸ¥è¯¢
- å¤æ‚æ–‡æ¡£é›†åˆ

### å‚æ•°é…ç½®
```python
{
    "top_k": 5,           # æœ€ç»ˆè¿”å›æ•°é‡
    "rerank_top_k": 20,   # å€™é€‰æ–‡æ¡£æ•°é‡
}
```

### ä½¿ç”¨å»ºè®®
- å€™é€‰æ–‡æ¡£æ•°å»ºè®®ä¸ºæœ€ç»ˆæ•°é‡çš„3-4å€
- Rerankeræ¨¡å‹æ¨èï¼šbge-reranker-v2-m3
- é€‚åˆå¤„ç†10-50ä¸ªå€™é€‰æ–‡æ¡£

---

## 3ï¸âƒ£ Fusion RAG (èåˆRAG)

### åŸç†
åŒæ—¶ä½¿ç”¨å‘é‡æ£€ç´¢ï¼ˆè¯­ä¹‰åŒ¹é…ï¼‰å’ŒBM25ï¼ˆå…³é”®è¯åŒ¹é…ï¼‰ï¼Œèåˆä¸¤ç§æ£€ç´¢ç»“æœã€‚

### æµç¨‹
```
              â”Œâ†’ å‘é‡æ£€ç´¢ â†’ å¾—åˆ†å½’ä¸€åŒ– â”
ç”¨æˆ·æŸ¥è¯¢ â†’ åˆ†è¯ â”¤                      â”œâ†’ åŠ æƒèåˆ â†’ LLMç”Ÿæˆ
              â””â†’ BM25æ£€ç´¢ â†’ å¾—åˆ†å½’ä¸€åŒ– â”˜
```

### ä¼˜ç‚¹
- âœ… ç»“åˆè¯­ä¹‰å’Œå…³é”®è¯ä¼˜åŠ¿
- âœ… å¯¹ä¸åŒç±»å‹æŸ¥è¯¢é²æ£’
- âœ… æé«˜å¬å›ç‡
- âœ… é€‚åº”æ€§å¼º

### ç¼ºç‚¹
- âŒ éœ€è¦æ„å»ºBM25ç´¢å¼•
- âŒ è®¡ç®—é‡è¾ƒå¤§
- âŒ éœ€è¦è°ƒæ•´æƒé‡å‚æ•°

### é€‚ç”¨åœºæ™¯
- å¤šæ ·åŒ–æŸ¥è¯¢ç±»å‹
- éœ€è¦ç²¾ç¡®å…³é”®è¯åŒ¹é…
- æ—¢æœ‰æ¦‚å¿µæŸ¥è¯¢åˆæœ‰ä¸“ä¸šæœ¯è¯­

### å‚æ•°é…ç½®
```python
{
    "top_k": 5,
    "vector_weight": 0.5,  # å‘é‡æ£€ç´¢æƒé‡
    "bm25_weight": 0.5,    # BM25æ£€ç´¢æƒé‡
}
```

### æƒé‡è°ƒæ•´å»ºè®®
- æ¦‚å¿µæ€§æŸ¥è¯¢ï¼š`vector_weight=0.7, bm25_weight=0.3`
- å…³é”®è¯æŸ¥è¯¢ï¼š`vector_weight=0.3, bm25_weight=0.7`
- å‡è¡¡æ¨¡å¼ï¼š`vector_weight=0.5, bm25_weight=0.5`

---

## 4ï¸âƒ£ HyDE RAG (å‡è®¾æ–‡æ¡£åµŒå…¥)

### åŸç†
ä¸ç›´æ¥ç”¨ç”¨æˆ·æŸ¥è¯¢æ£€ç´¢ï¼Œè€Œæ˜¯å…ˆè®©LLMç”Ÿæˆä¸€ä¸ª"å‡è®¾çš„ç­”æ¡ˆ"ï¼Œç”¨è¿™ä¸ªå‡è®¾ç­”æ¡ˆå»æ£€ç´¢ã€‚

### æµç¨‹
```
ç”¨æˆ·æŸ¥è¯¢ â†’ LLMç”Ÿæˆå‡è®¾ç­”æ¡ˆ â†’ ç”¨å‡è®¾ç­”æ¡ˆæ£€ç´¢ â†’ è·å–çœŸå®æ–‡æ¡£ â†’ LLMç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ
```

### ä¼˜ç‚¹
- âœ… æ”¹å–„æŸ¥è¯¢-æ–‡æ¡£è¯­ä¹‰åŒ¹é…
- âœ… å¤„ç†æŠ½è±¡æˆ–å¤æ‚æŸ¥è¯¢
- âœ… æé«˜æ£€ç´¢å¬å›ç‡
- âœ… é€‚åˆæ¦‚å¿µæ€§é—®é¢˜

### ç¼ºç‚¹
- âŒ éœ€è¦é¢å¤–LLMè°ƒç”¨
- âŒ å»¶è¿Ÿè¾ƒé«˜
- âŒ tokenæ¶ˆè€—å¢åŠ 
- âŒ å¯èƒ½äº§ç”Ÿè¯¯å¯¼æ€§å‡è®¾

### é€‚ç”¨åœºæ™¯
- æŠ½è±¡æ¦‚å¿µæŸ¥è¯¢
- å¤æ‚æŠ€æœ¯é—®é¢˜
- éœ€è¦æ·±åº¦ç†è§£çš„æŸ¥è¯¢

### å‚æ•°é…ç½®
```python
{
    "top_k": 5,
    "num_hypotheses": 1,  # ç”Ÿæˆå‡è®¾æ–‡æ¡£æ•°é‡
}
```

### ä½¿ç”¨å»ºè®®
- é€‚åˆå¤„ç†"ä¸ºä»€ä¹ˆ"ã€"æ€ä¹ˆæ ·"ç±»é—®é¢˜
- ä¸é€‚åˆç®€å•çš„äº‹å®æŸ¥è¯¢
- å‡è®¾æ–‡æ¡£é•¿åº¦å»ºè®®300-500å­—ç¬¦

---

## 5ï¸âƒ£ Contextual Compression RAG (ä¸Šä¸‹æ–‡å‹ç¼©)

### åŸç†
æ£€ç´¢åˆ°æ–‡æ¡£åï¼Œç”¨LLMæå–æ¯ä¸ªæ–‡æ¡£ä¸­ä¸æŸ¥è¯¢æœ€ç›¸å…³çš„å…³é”®ä¿¡æ¯ï¼Œå»é™¤æ— å…³å†…å®¹ã€‚

### æµç¨‹
```
ç”¨æˆ·æŸ¥è¯¢ â†’ å‘é‡æ£€ç´¢(top 10) â†’ LLMé€ä¸ªå‹ç¼©æ–‡æ¡£ â†’ ä¿ç•™å…³é”®ä¿¡æ¯ â†’ LLMç”Ÿæˆç­”æ¡ˆ
```

### ä¼˜ç‚¹
- âœ… å»é™¤æ— å…³ä¿¡æ¯å’Œå™ªéŸ³
- âœ… é™ä½LLMè¾“å…¥tokenæ•°
- âœ… æé«˜ç­”æ¡ˆå‡†ç¡®æ€§
- âœ… çªå‡ºå…³é”®å†…å®¹

### ç¼ºç‚¹
- âŒ éœ€è¦å¤šæ¬¡LLMè°ƒç”¨ï¼ˆæ¯ä¸ªæ–‡æ¡£ä¸€æ¬¡ï¼‰
- âŒ å»¶è¿Ÿæœ€é«˜
- âŒ æˆæœ¬è¾ƒé«˜
- âŒ å¯èƒ½ä¸¢å¤±éƒ¨åˆ†ä¸Šä¸‹æ–‡

### é€‚ç”¨åœºæ™¯
- é•¿æ–‡æ¡£å¤„ç†
- å™ªéŸ³è¾ƒå¤šçš„æ–‡æ¡£
- å¯¹ç²¾ç¡®åº¦è¦æ±‚æé«˜çš„åœºæ™¯

### å‚æ•°é…ç½®
```python
{
    "top_k": 5,             # æœ€ç»ˆè¿”å›æ•°é‡
    "compression_top_k": 10 # å€™é€‰æ–‡æ¡£æ•°é‡
}
```

### ä½¿ç”¨å»ºè®®
- é€‚åˆæ–‡æ¡£é•¿åº¦>1000å­—ç¬¦çš„åœºæ™¯
- å‹ç¼©å¯èŠ‚çœ30-70%çš„token
- å»ºè®®å€™é€‰æ–‡æ¡£æ•°ä¸ºæœ€ç»ˆæ•°é‡çš„2å€

---

## ğŸ”„ æŠ€æœ¯å¯¹æ¯”

### å‡†ç¡®æ€§æ’åº
```
Contextual Compression â‰ˆ Reranker > Fusion > HyDE > Simple
```

### é€Ÿåº¦æ’åº
```
Simple > Fusion > Reranker > HyDE > Contextual Compression
```

### æˆæœ¬æ’åºï¼ˆLLMè°ƒç”¨æ¬¡æ•°ï¼‰
```
Simple(1æ¬¡) < Reranker(1æ¬¡) < Fusion(1æ¬¡) < HyDE(2æ¬¡) < Compression(n+1æ¬¡)
```

### å®ç°å¤æ‚åº¦
```
Simple < HyDE < Reranker < Fusion < Contextual Compression
```

---

## ğŸ’¡ é€‰æ‹©å»ºè®®

### åœºæ™¯1ï¼šå¿«é€ŸåŸå‹
**æ¨è**ï¼šSimple RAG
- å¿«é€ŸéªŒè¯å¯è¡Œæ€§
- äº†è§£æ•°æ®è´¨é‡

### åœºæ™¯2ï¼šç”Ÿäº§ç¯å¢ƒ
**æ¨è**ï¼šReranker RAG
- å¹³è¡¡æ•ˆæœå’Œæ€§èƒ½
- æ˜¾è‘—æå‡å‡†ç¡®æ€§

### åœºæ™¯3ï¼šå¤šæ ·åŒ–æŸ¥è¯¢
**æ¨è**ï¼šFusion RAG
- é€‚åº”ä¸åŒæŸ¥è¯¢ç±»å‹
- æé«˜é²æ£’æ€§

### åœºæ™¯4ï¼šå¤æ‚é—®é¢˜
**æ¨è**ï¼šHyDE RAG + Reranker RAG ç»„åˆ
- HyDEæ”¹å–„æ£€ç´¢
- Rerankerç²¾ç¡®ç­›é€‰

### åœºæ™¯5ï¼šé•¿æ–‡æ¡£é«˜ç²¾åº¦
**æ¨è**ï¼šContextual Compression RAG
- å¤„ç†é•¿æ–‡æ¡£
- è¿½æ±‚æè‡´å‡†ç¡®æ€§

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. å•æŠ€æœ¯ä½¿ç”¨
```python
# å¼€å‘é˜¶æ®µï¼šä½¿ç”¨Simple RAGå¿«é€Ÿè¿­ä»£
techniques = ["simple_rag"]

# ç”Ÿäº§ç¯å¢ƒï¼šä½¿ç”¨Reranker RAGæå‡è´¨é‡
techniques = ["reranker_rag"]
```

### 2. å¤šæŠ€æœ¯å¯¹æ¯”
```python
# è¯„æµ‹æ¨¡å¼ï¼šåŒæ—¶æµ‹è¯•å¤šä¸ªæŠ€æœ¯
techniques = [
    "simple_rag",
    "reranker_rag", 
    "fusion_rag"
]
```

### 3. æŠ€æœ¯ç»„åˆï¼ˆæœªæ¥æ”¯æŒï¼‰
```python
# Pipelineç»„åˆ
pipeline = [
    "fusion_rag",      # æ··åˆæ£€ç´¢
    "reranker_rag",    # ç²¾ç¡®é‡æ’
    "compression_rag"  # å‹ç¼©ä¼˜åŒ–
]
```

---

## ğŸ“Š æ€§èƒ½å‚è€ƒ

åŸºäºAI_Information.pdfæµ‹è¯•ï¼ˆ26ä¸ªæ–‡æœ¬å—ï¼‰ï¼š

| æŠ€æœ¯ | å¹³å‡è€—æ—¶ | å‡†ç¡®ç‡ | ç›¸å…³æ€§ | Tokenæ¶ˆè€— |
|------|---------|--------|--------|----------|
| Simple | 3.2s | 75% | 80% | 1000 |
| Reranker | 4.5s | 85% | 90% | 1000 |
| Fusion | 4.0s | 82% | 88% | 1000 |
| HyDE | 5.8s | 78% | 85% | 1500 |
| Compression | 8.5s | 88% | 92% | 600 |

*æ³¨ï¼šæ•°æ®ä»…ä¾›å‚è€ƒï¼Œå®é™…æ•ˆæœå–å†³äºæ–‡æ¡£è´¨é‡å’ŒæŸ¥è¯¢ç±»å‹*

---

## ğŸ”§ æ•…éšœæ’é™¤

### Reranker RAGå¤±è´¥
- æ£€æŸ¥RerankeræœåŠ¡æ˜¯å¦å¯ç”¨
- éªŒè¯APIå¯†é’¥æ­£ç¡®
- ç¡®è®¤æ¨¡å‹åç§°æ­£ç¡®

### Fusion RAGæ…¢
- å‡å°‘å€™é€‰æ–‡æ¡£æ•°é‡
- è°ƒæ•´æ£€ç´¢å‚æ•°
- è€ƒè™‘ä½¿ç”¨Simpleæˆ–Reranker

### HyDEç”Ÿæˆä¸ä½³
- è°ƒæ•´æ¸©åº¦å‚æ•°ï¼ˆæ¨è0.7ï¼‰
- ä¼˜åŒ–å‡è®¾æ–‡æ¡£æç¤ºè¯
- æ£€æŸ¥LLMæœåŠ¡è´¨é‡

### Compressionè¶…æ—¶
- å‡å°‘compression_top_k
- å¢åŠ è¶…æ—¶æ—¶é—´
- ä½¿ç”¨æ›´å¿«çš„LLM

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [Simple RAG](../src/full/01_simple_rag.ipynb)
- [Reranker RAG](../src/full/08_reranker.ipynb)
- [Fusion RAG](../src/full/16_fusion_rag.ipynb)
- [HyDE RAG](../src/full/19_HyDE_rag.ipynb)
- [Contextual Compression](../src/full/10_contextual_compression.ipynb)

---

**ä¸‹ä¸€æ­¥**ï¼šæ¢ç´¢æ›´å¤šRAGæŠ€æœ¯ï¼ŸæŸ¥çœ‹ [å®Œæ•´RAGæŠ€æœ¯åˆ—è¡¨](../README.md)

